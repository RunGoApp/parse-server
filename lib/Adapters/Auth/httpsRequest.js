'use strict';

const https = require('https');

function makeCallback(resolve, reject, noJSON) {
  return function (res) {
    let data = '';
    res.on('data', chunk => {
      data += chunk;
    });
    res.on('end', () => {
      if (noJSON) {
        return resolve(data);
      }
      try {
        data = JSON.parse(data);
      } catch (e) {
        return reject(e);
      }
      resolve(data);
    });
    res.on('error', reject);
  };
}

function get(options, noJSON = false) {
  return new Promise((resolve, reject) => {
    https.get(options, makeCallback(resolve, reject, noJSON)).on('error', reject);
  });
}

function request(options, postData) {
  return new Promise((resolve, reject) => {
    const req = https.request(options, makeCallback(resolve, reject));
    req.on('error', reject);
    req.write(postData);
    req.end();
  });
}

module.exports = { get, request };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BZGFwdGVycy9BdXRoL2h0dHBzUmVxdWVzdC5qcyJdLCJuYW1lcyI6WyJodHRwcyIsInJlcXVpcmUiLCJtYWtlQ2FsbGJhY2siLCJyZXNvbHZlIiwicmVqZWN0Iiwibm9KU09OIiwicmVzIiwiZGF0YSIsIm9uIiwiY2h1bmsiLCJKU09OIiwicGFyc2UiLCJlIiwiZ2V0Iiwib3B0aW9ucyIsIlByb21pc2UiLCJyZXF1ZXN0IiwicG9zdERhdGEiLCJyZXEiLCJ3cml0ZSIsImVuZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsUUFBUUMsUUFBUSxPQUFSLENBQWQ7O0FBRUEsU0FBU0MsWUFBVCxDQUFzQkMsT0FBdEIsRUFBK0JDLE1BQS9CLEVBQXVDQyxNQUF2QyxFQUErQztBQUM3QyxTQUFPLFVBQVNDLEdBQVQsRUFBYztBQUNuQixRQUFJQyxPQUFPLEVBQVg7QUFDQUQsUUFBSUUsRUFBSixDQUFPLE1BQVAsRUFBZUMsU0FBUztBQUN0QkYsY0FBUUUsS0FBUjtBQUNELEtBRkQ7QUFHQUgsUUFBSUUsRUFBSixDQUFPLEtBQVAsRUFBYyxNQUFNO0FBQ2xCLFVBQUlILE1BQUosRUFBWTtBQUNWLGVBQU9GLFFBQVFJLElBQVIsQ0FBUDtBQUNEO0FBQ0QsVUFBSTtBQUNGQSxlQUFPRyxLQUFLQyxLQUFMLENBQVdKLElBQVgsQ0FBUDtBQUNELE9BRkQsQ0FFRSxPQUFPSyxDQUFQLEVBQVU7QUFDVixlQUFPUixPQUFPUSxDQUFQLENBQVA7QUFDRDtBQUNEVCxjQUFRSSxJQUFSO0FBQ0QsS0FWRDtBQVdBRCxRQUFJRSxFQUFKLENBQU8sT0FBUCxFQUFnQkosTUFBaEI7QUFDRCxHQWpCRDtBQWtCRDs7QUFFRCxTQUFTUyxHQUFULENBQWFDLE9BQWIsRUFBc0JULFNBQVMsS0FBL0IsRUFBc0M7QUFDcEMsU0FBTyxJQUFJVSxPQUFKLENBQVksQ0FBQ1osT0FBRCxFQUFVQyxNQUFWLEtBQXFCO0FBQ3RDSixVQUNHYSxHQURILENBQ09DLE9BRFAsRUFDZ0JaLGFBQWFDLE9BQWIsRUFBc0JDLE1BQXRCLEVBQThCQyxNQUE5QixDQURoQixFQUVHRyxFQUZILENBRU0sT0FGTixFQUVlSixNQUZmO0FBR0QsR0FKTSxDQUFQO0FBS0Q7O0FBRUQsU0FBU1ksT0FBVCxDQUFpQkYsT0FBakIsRUFBMEJHLFFBQTFCLEVBQW9DO0FBQ2xDLFNBQU8sSUFBSUYsT0FBSixDQUFZLENBQUNaLE9BQUQsRUFBVUMsTUFBVixLQUFxQjtBQUN0QyxVQUFNYyxNQUFNbEIsTUFBTWdCLE9BQU4sQ0FBY0YsT0FBZCxFQUF1QlosYUFBYUMsT0FBYixFQUFzQkMsTUFBdEIsQ0FBdkIsQ0FBWjtBQUNBYyxRQUFJVixFQUFKLENBQU8sT0FBUCxFQUFnQkosTUFBaEI7QUFDQWMsUUFBSUMsS0FBSixDQUFVRixRQUFWO0FBQ0FDLFFBQUlFLEdBQUo7QUFDRCxHQUxNLENBQVA7QUFNRDs7QUFFREMsT0FBT0MsT0FBUCxHQUFpQixFQUFFVCxHQUFGLEVBQU9HLE9BQVAsRUFBakIiLCJmaWxlIjoiaHR0cHNSZXF1ZXN0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgaHR0cHMgPSByZXF1aXJlKCdodHRwcycpO1xuXG5mdW5jdGlvbiBtYWtlQ2FsbGJhY2socmVzb2x2ZSwgcmVqZWN0LCBub0pTT04pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uKHJlcykge1xuICAgIGxldCBkYXRhID0gJyc7XG4gICAgcmVzLm9uKCdkYXRhJywgY2h1bmsgPT4ge1xuICAgICAgZGF0YSArPSBjaHVuaztcbiAgICB9KTtcbiAgICByZXMub24oJ2VuZCcsICgpID0+IHtcbiAgICAgIGlmIChub0pTT04pIHtcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoZGF0YSk7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0dXJuIHJlamVjdChlKTtcbiAgICAgIH1cbiAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgfSk7XG4gICAgcmVzLm9uKCdlcnJvcicsIHJlamVjdCk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGdldChvcHRpb25zLCBub0pTT04gPSBmYWxzZSkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGh0dHBzXG4gICAgICAuZ2V0KG9wdGlvbnMsIG1ha2VDYWxsYmFjayhyZXNvbHZlLCByZWplY3QsIG5vSlNPTikpXG4gICAgICAub24oJ2Vycm9yJywgcmVqZWN0KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHJlcXVlc3Qob3B0aW9ucywgcG9zdERhdGEpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCByZXEgPSBodHRwcy5yZXF1ZXN0KG9wdGlvbnMsIG1ha2VDYWxsYmFjayhyZXNvbHZlLCByZWplY3QpKTtcbiAgICByZXEub24oJ2Vycm9yJywgcmVqZWN0KTtcbiAgICByZXEud3JpdGUocG9zdERhdGEpO1xuICAgIHJlcS5lbmQoKTtcbiAgfSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0geyBnZXQsIHJlcXVlc3QgfTsiXX0=